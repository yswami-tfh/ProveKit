mod tests {
    use crate::verify_eddsa_poseidon2;

    #[test]
    fn test_case1() {
        let x = 15861662102942198476185518224532077347254150735350796263259682790715259346390;
        let y = 17622332940847650587004774926435083207962382856110852169511204932927794212320;
        let signature = [
            19090079173373584153996824137084726661643725553797485823319088208683554498717,
            3643574957097202527589616469273298197083911730855228311907034680488748021268,
        ];
        let signature_s =
            2128104906629434075529508057546284580247227319347477887390422344724817923329;
        let message = 3126080974277891902445700130528654565374341115115698716199527644337840721369;

        let is_valid = verify_eddsa_poseidon2(x, y, signature_s, signature, message);
        assert(is_valid, "Valid signature should verify successfully");
    }
    #[test]
    fn test_case2() {
        let x = 799588856343464002877028562222211497330129187319590508049257685786236700114;
        let y = 14902389233276705483052996479987000276830365610862573825891673167255962507742;

        let signature = [
            234874950623680517572578303006997285290588653466131574034573396955894832795,
            16541008635573367613475848393577493564676156592887182984237738769555298223333,
        ];

        let signature_s = 9145191237582650454380099957761658105575586283663674279318986596761559773;
        let message = 2915128568691568051790179173058040565240368703618887264694651479943038317157;

        let is_valid = verify_eddsa_poseidon2(x, y, signature_s, signature, message);
        assert(is_valid, "Valid signature should verify successfully");
    }

    #[test]
    fn test_case3() {
        let x = 15861662102942198476185518224532077347254150735350796263259682790715259346390;
        let y = 17622332940847650587004774926435083207962382856110852169511204932927794212320;
        let signature = [
            15861662102942198476185518224532077347254150735350796263259682790715259346390,
            17622332940847650587004774926435083207962382856110852169511204932927794212320,
        ];
        let signature_s =
            2028104906629434075529508057546284580247227319347477887390422344724817923329;
        let message = 3126080974277891902445700130528654565374341115115698716199527644337840721369;
        let is_valid = verify_eddsa_poseidon2(x, y, signature_s, signature, message);
        assert(!is_valid, "Invalid signature should not verify successfully");
    }

    #[test]
    fn test_case4() {
        let x = 15861662102942198476185518224532077347254150735350796263259682790715259346390;
        let y = 17622332940847650587004774926435083207962382856110852169511204932927794212320;
        let signature = [
            19090079173373584153996824137084726661643725553797485823319088208683554498717,
            3643574957097202527589616469273298197083911730855228311907034680488748021268,
        ];
        let signature_s =
            4864135265609343478310308775703443966324041291506045146590638005673265296370;
        let message = 3126080974277891902445700130528654565374341115115698716199527644337840721369;
        let is_valid = verify_eddsa_poseidon2(x, y, signature_s, signature, message);
        assert(!is_valid, "Invalid signature (S out of range) should not verify successfully");
    }
}
